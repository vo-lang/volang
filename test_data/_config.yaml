# Vo Integration Test Configuration
#
# Tests NOT listed here will run in BOTH vm and jit modes and expected to pass.
#
# Format:
#   tests:
#     - file: path/to/test.vo      # Relative to test_data/
#       skip: [vm, jit]            # Optional: skip modes (vm, jit, or both)
#       should_fail: true          # Optional: must fail at compile/type-check
#       reason: "why"              # Optional: reason for skip/should_fail

tests:
  - file: channel_send.vo
  - file: clone_immediate_read.vo
  - file: complex_literal.vo
  - file: const.vo
  - file: const_fold.vo
  - file: constant.vo
  - file: debug_array_index.vo
  - file: debug_clone.vo
  - file: debug_escaped_array.vo
  - file: debug_iface_bugs.vo
  - file: debug_sequence.vo
  - file: defer_stmt.vo
  - file: dyn_write_no_error_return.vo
    should_fail: true
    reason: "dynamic write requires function with error return value"
  - file: dyn_write_fast_path.vo
  - file: embed_iface_simple.vo
  - file: embed_interface.vo
  - file: embed_interface_impl.vo
  - file: embed_method.vo
  - file: embed_pointer.vo
  - file: embed_shadow.vo
  - file: embed_struct.vo
  - file: escape_return_value.vo
  - file: escape_struct_assign.vo
  - file: fib_goroutine.vo
  - file: field_offset_debug.vo
  - file: for_stmt.vo
  - file: label_stmt.vo
  - file: go_stmt.vo
  - file: goto_stmt.vo
    should_fail: true
    reason: "goto is not supported"
  - file: hex_literal_debug.vo
  - file: iface_escape_closure.vo
  - file: iface_to_iface_assertion.vo
  - file: init_call_error.vo
    should_fail: true
    reason: "init() cannot be called explicitly"
  - file: interface.vo
  - file: interface_closure.vo
  - file: interface_complex_subset.vo
  - file: interface_conversion.vo
  - file: interface_method_set.vo
  - file: interface_pointer.vo
  - file: interface_simple.vo
  - file: local_type.vo
  - file: map.vo
  - file: method_dispatch_bug.vo
  - file: minimal_bug.vo
  - file: minimal_bug2.vo
  - file: multi_init.vo
  - file: multi_type_method.vo
  - file: nested_clone_test.vo
  - file: nested_struct_bug.vo
  - file: point_then_rect.vo
  - file: pointer_basic.vo
  - file: pointer_comprehensive.vo
  - file: pointer_embedded.vo
  - file: pointer_method_call.vo
  - file: proj_multifile/
  - file: proj_taskman/
  - file: qualified_embed_iface.vo
  - file: range_string.vo
  - file: rect_only.vo
  - file: rect_only_sum.vo
  - file: rune_literal.vo
  - file: select_stmt.vo
  - file: select_stmt_assert_fail.vo
    should_fail: true
    reason: "assert(false) is compile-time error"
  - file: setfield_getfield_test.vo
  - file: shift_ops.vo
  - file: setfield_test.vo
  - file: simple_clone_test.vo
  - file: array_slice.vo
  - file: bitwise_ops.vo
  - file: slice.vo
  - file: slice_map.vo
  - file: slice_ops.vo
  - file: stack_array_iter.vo
  - file: stack_vs_escaped_array.vo
  - file: stdlib/base64.vo
    skip: [vm, jit]
    reason: "stdlib not ready"
  - file: stdlib/bytes.vo
  - file: io_package.vo
  - file: stdlib/errors.vo
    skip: [vm, jit]
    reason: "stdlib not ready"
  - file: stdlib/hex.vo
    skip: [vm, jit]
    reason: "stdlib not ready"
  - file: stdlib/math.vo
    skip: [vm, jit]
    reason: "stdlib not ready"
  - file: stdlib/regexp.vo
    skip: [vm, jit]
    reason: "stdlib not ready"
  - file: stdlib/sort.vo
    skip: [vm, jit]
    reason: "stdlib not ready"
  - file: stdlib/strconv.vo
    skip: [vm, jit]
    reason: "stdlib not ready"
  - file: stdlib/strings.vo
    skip: [vm, jit]
    reason: "stdlib not ready"
  - file: stdlib/unicode.vo
    skip: [vm, jit]
    reason: "stdlib not ready"
  - file: struct_method_simple.vo
  - file: struct_object.vo
  - file: switch_stmt.vo
  - file: three_index_slice.vo
  - file: named_return.vo
  - file: fallthrough.vo
  - file: escaped_array_init.vo
  - file: type_switch.vo
  - file: type_assertion.vo
  - file: type_assertion_ok.vo
  - file: typed_nil_interface.vo
  - file: type_debug.vo
  - file: value_receiver_bug.vo
  - file: var_dependency.vo
  - file: var_init_complex.vo
  - file: var_init_func.vo
  - file: var_init_order.vo
  # Extension syntax tests
  - file: fail_stmt.vo
  - file: question_operator.vo
  - file: errdefer_stmt.vo
  - file: debug_nil_interface.vo
  - file: debug_iface.vo

  # Zip file tests
  - file: zip/single_file.zip
  - file: zip/multi.zip
  - file: zip/subdir.zip
    zip_root: src/
    reason: "project in src/ subdirectory"

  # Typechecker tests - should_fail: pointer must be struct
  - file: typechecker/pointer_must_be_struct.vo
    should_fail: true
    reason: "pointer types must point to struct types (Vo spec)"
  - file: typechecker/addr_of_must_be_struct.vo
    should_fail: true
    reason: "address-of operator only valid for struct types (Vo spec)"
  - file: typechecker/dyn_protocol_error.vo
    should_fail: true
    reason: "concrete type without protocol method should fail"

  # JIT bugs - tests not in original config
  - file: array_slice_get_set.vo
  - file: bytes_buffer.vo
  - file: dyn_access.vo
  - file: dyn_access_big_struct.vo
  - file: dyn_access_interface_field.vo
  - file: dyn_access_interface_itab_bug.vo
  - file: dyn_access_slice_interface_elem.vo
  - file: dyn_call_args.vo
  - file: dyn_call_methods.vo
  - file: dyn_call_multi_slot_ret.vo
  - file: dyn_call_question.vo
  - file: dyn_call_ret_array.vo
  - file: dyn_call_ret_types.vo
  - file: dyn_call_simple.vo
  - file: dyn_get_attr.vo
  - file: dyn_get_method.vo
  - file: dyn_get_method_simple.vo
  - file: dyn_member_method.vo
  - file: dyn_method_value_receiver.vo
  - file: dyn_set_attr_iface_mismatch.vo
  - file: dyn_set_attr_interface_field.vo
  - file: dyn_try_unwrap.vo
  - file: dyn_write.vo
  - file: dyn_api.vo
  - file: error_handling_sugar.vo
  - file: gc_closure_capture.vo
  - file: iface_to_iface_assign.vo
  - file: io_readfull_only.vo
  - file: nil_slice_map.vo
  - file: packed_array.vo
  - file: private_type_itab.vo
  - file: jit/native_math.vo
  - file: jit/native_strings.vo
  - file: jit/string_split.vo

  # Typechecker tests - JIT bugs
  - file: typechecker/assignable_channel.vo
  - file: typechecker/assignable_identical.vo
  - file: typechecker/assignable_interface.vo
  - file: typechecker/assignable_nil.vo
  - file: typechecker/interface_embedding.vo
  - file: typechecker/method_sig_complex_params.vo
  - file: typechecker/method_sig_func_types.vo
  - file: typechecker/type_assertion.vo
  - file: typechecker/type_conversion.vo
  - file: typechecker/interface_complex_hierarchy.vo

# Typechecker tests - known bugs (now fixed)
# FIXED: typechecker/assignable_interface.vo - recv_slots issue in wrapper
# FIXED: typechecker/interface_embedding.vo - interface-to-interface itab lookup
# FIXED: typechecker/bug_empty_struct_interface.vo - needs_unbox check in wrapper
# FIXED: typechecker/bug_interface_multi_return.vo - needs_unbox check in wrapper
# FIXED: typechecker/bug_named_type_interface.vo - needs_unbox check in wrapper
# FIXED: typechecker/method_set_equivalence.vo - interface parameter works
# FIXED: typechecker/bug_ptr_embed_interface.vo - promoted method wrapper for pointer embedding
# FIXED: typechecker/type_assertion.vo - interface-to-interface assignment now preserves reference semantics
