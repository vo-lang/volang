package time

// Native externs
func nowUnixNano() int64
func nowMonoNano() int64
func waitio_sleepNano(d int64)

type Duration int64

const (
	Nanosecond Duration = 1
	Microsecond         = 1000 * Nanosecond
	Millisecond         = 1000 * Microsecond
	Second              = 1000 * Millisecond
	Minute              = 60 * Second
	Hour                = 60 * Minute
)

type Time struct {
	unixNano int64
	monoNano int64
}

func Now() Time {
	return Time{unixNano: nowUnixNano(), monoNano: nowMonoNano()}
}

func (t Time) UnixNano() int64 { return t.unixNano }
func (t Time) MonoNano() int64 { return t.monoNano }

func Since(t Time) Duration {
	return Duration(nowMonoNano() - t.monoNano)
}

func Sleep(d Duration) {
	waitio_sleepNano(int64(d))
}

func (d Duration) Nanoseconds() int64 { return int64(d) }
func (d Duration) Microseconds() int64 { return int64(d / Microsecond) }
func (d Duration) Milliseconds() int64 { return int64(d / Millisecond) }
func (d Duration) Seconds() int64 { return int64(d / Second) }
