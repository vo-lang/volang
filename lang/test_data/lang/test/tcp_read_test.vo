package main

import "net"

func main() {
	println("Testing TCP read...")
	
	// Dial
	conn, err := net.Dial("tcp", "httpbin.org:80")
	if err != nil {
		println("Dial failed:", err.Error())
		return
	}
	println("Connected!")
	
	// Write HTTP request
	req := "GET /get HTTP/1.1\r\nHost: httpbin.org\r\n\r\n"
	n, err := conn.Write([]byte(req))
	if err != nil {
		println("Write failed:", err.Error())
		conn.Close()
		return
	}
	println("Wrote", n, "bytes")
	
	// Read response
	println("Reading response...")
	buf := make([]byte, 1024)
	n, err = conn.Read(buf)
	println("Read returned: n=", n)
	if err != nil {
		println("Read error:", err.Error())
	} else {
		println("Read", n, "bytes:")
		println(string(buf[:n]))
	}
	
	conn.Close()
	println("Done")
}
