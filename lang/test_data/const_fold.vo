package main


import "fmt"
// ========== Compile-time Constant Folding Tests ==========
// These tests verify that constant expressions are evaluated at compile time.
// Key evidence: iota only has meaning at compile time

const (
    // Basic arithmetic folding
    add = 1 + 2 + 3 + 4 + 5           // = 15
    sub = 100 - 50 - 25              // = 25
    mul = 2 * 3 * 4 * 5              // = 120
    div = 1000 / 10 / 5              // = 20
    mod = 17 % 5                     // = 2
    
    // Nested expressions
    nested = (1 + 2) * (3 + 4) - 5   // = 3 * 7 - 5 = 16
    
    // Chained constants
    base = 10
    derived1 = base * 2              // = 20
    derived2 = derived1 + base       // = 30
    derived3 = derived2 * derived1   // = 600
    
    // Bit operations
    bits1 = 1 << 4                   // = 16
    bits2 = 255 >> 4                 // = 15
    bits3 = 0xF0 & 0x0F              // = 0
    bits4 = 0xF0 | 0x0F              // = 255
    bits5 = 0xFF ^ 0x0F              // = 240
    
    // Large shift (proves compile-time arbitrary precision)
    bigShift = 1 << 62               // = 2^62
)

const (
    // iota - only meaningful at compile time
    iota0 = iota                     // = 0
    iota1 = iota                     // = 1
    iota2 = iota                     // = 2
)

const (
    // Float constant folding
    pi = 3.14159
    tau = pi * 2                     // = 6.28318
    piSquared = pi * pi              // â‰ˆ 9.8696
)

func main() {
    // Verify arithmetic folding
    assert(add == 15, "add should be 15")
    assert(sub == 25, "sub should be 25")
    assert(mul == 120, "mul should be 120")
    assert(div == 20, "div should be 20")
    assert(mod == 2, "mod should be 2")
    assert(nested == 16, "nested should be 16")
    
    // Verify chained constants
    assert(base == 10, "base should be 10")
    assert(derived1 == 20, "derived1 should be 20")
    assert(derived2 == 30, "derived2 should be 30")
    assert(derived3 == 600, "derived3 should be 600")
    
    // Verify bit operations
    assert(bits1 == 16, "bits1 should be 16")
    assert(bits2 == 15, "bits2 should be 15")
    assert(bits3 == 0, "bits3 should be 0")
    assert(bits4 == 255, "bits4 should be 255")
    assert(bits5 == 240, "bits5 should be 240")
    
    // Verify large shift (proves compile-time arbitrary precision)
    assert(bigShift == 4611686018427387904, "bigShift should be 2^62")
    
    // Verify iota (proves compile-time evaluation)
    assert(iota0 == 0, "iota0 should be 0")
    assert(iota1 == 1, "iota1 should be 1")
    assert(iota2 == 2, "iota2 should be 2")
    
    // Verify float folding
    assert(tau > 6.28, "tau should be > 6.28")
    assert(tau < 6.29, "tau should be < 6.29")
    assert(piSquared > 9.86, "piSquared should be > 9.86")
    assert(piSquared < 9.87, "piSquared should be < 9.87")
    
    fmt.Println("const_fold_test: ALL PASSED")
}
