package main

import (
	"fmt"
	"sort"
)

func main() {
    fmt.Println("Starting sort tests...")
    
    // Test sorting integers
    ints := []int{5, 2, 8, 1, 9, 3}
    assert(!sort.IntsAreSorted(ints), "unsorted ints should not be sorted")
    sort.Ints(ints)
    assert(sort.IntsAreSorted(ints), "sorted ints should be sorted")
    assert(ints[0] == 1, "first element should be 1")
    assert(ints[5] == 9, "last element should be 9")
    
    // Test searching integers
    idx := sort.SearchInts(ints, 5)
    assert(idx == 3, "SearchInts should find 5 at index 3")
    
    idx2 := sort.SearchInts(ints, 4)
    assert(idx2 == 3, "SearchInts should return 3 for 4 (insertion point between 3 and 5)")
    
    // Test reverse
    sort.Reverse(ints)
    assert(ints[0] == 9, "after reverse, first should be 9")
    assert(ints[5] == 1, "after reverse, last should be 1")
    
    // Test empty/single element slices
    empty := []int{}
    sort.Ints(empty)
    assert(sort.IntsAreSorted(empty), "empty slice should be sorted")
    
    single := []int{42}
    sort.Ints(single)
    assert(sort.IntsAreSorted(single), "single element should be sorted")
    
    // Test sort.Interface
    testSortInterface()

    fmt.Println("All sort tests passed!")
}

type IntSlice struct {
    data []int
}

func (s IntSlice) Len() int           { return len(s.data) }
func (s IntSlice) Less(i, j int) bool { return s.data[i] < s.data[j] }
func (s IntSlice) Swap(i, j int)      { s.data[i], s.data[j] = s.data[j], s.data[i] }

func testSortInterface() {
    s := IntSlice{data: []int{5, 2, 8, 1, 9, 3}}
    assert(!sort.IsSorted(s), "unsorted should not be sorted")
    sort.Sort(s)
    assert(sort.IsSorted(s), "after Sort, should be sorted")
    assert(s.data[0] == 1, "first should be 1")
    assert(s.data[5] == 9, "last should be 9")

    s2 := IntSlice{data: []int{5, 2, 8, 1, 9, 3}}
    sort.Stable(s2)
    assert(sort.IsSorted(s2), "after Stable, should be sorted")
    assert(s2.data[0] == 1, "first should be 1")
}
