// Test: nested type switch with init statements
// Coverage: complex type switch scenarios
package main


import "fmt"
type Inner struct {
    val int
}

type Outer struct {
    inner Inner
}

func getVal(x any) int {
    switch v := x.(type) {
    case int:
        return v
    case string:
        return len(v)
    case Inner:
        return v.val
    case Outer:
        // Nested type switch on inner field
        switch iv := any(v.inner).(type) {
        case Inner:
            return iv.val * 10
        default:
            return -1
        }
    default:
        return 0
    }
}

func withInit(x any) int {
    // Type switch with init statement
    switch y := 100; v := x.(type) {
    case int:
        return v + y
    case string:
        return len(v) + y
    default:
        return y
    }
}

func multiCase(x any) string {
    switch x.(type) {
    case int, int8, int16, int32, int64:
        return "signed int"
    case uint, uint8, uint16, uint32, uint64:
        return "unsigned int"
    case float32, float64:
        return "float"
    case string:
        return "string"
    case nil:
        return "nil"
    default:
        return "other"
    }
}

func main() {
    // Test 1: basic type switch
    assert(getVal(42) == 42, "int case")
    assert(getVal("hello") == 5, "string case")
    assert(getVal(Inner{val: 7}) == 7, "Inner case")
    
    // Test 2: nested type switch
    assert(getVal(Outer{inner: Inner{val: 3}}) == 30, "nested type switch")
    
    // Test 3: with init statement
    assert(withInit(5) == 105, "init + int")
    assert(withInit("ab") == 102, "init + string")
    assert(withInit(3.14) == 100, "init + default")
    
    // Test 4: multi-type case
    assert(multiCase(int(1)) == "signed int", "int")
    assert(multiCase(int32(1)) == "signed int", "int32")
    assert(multiCase(uint(1)) == "unsigned int", "uint")
    assert(multiCase(float64(1.0)) == "float", "float64")
    assert(multiCase("x") == "string", "string")
    
    // Test 5: nil case
    var nilIface any
    assert(multiCase(nilIface) == "nil", "nil interface")
    
    fmt.Println("nested_type_switch: ok")
}
